
# coverage_stats.py

## Help message
```
Description: The program finds unique isoforms by samples and genomic regions

positional arguments:
  manifest            string	input manifest csv file in format: sample,bam,fa.  e.g. /in/manifest.csv
  inBed               string	input bed file.  e.g. /in/window.bed
  outFile             string	output file.  e.g. /out/file.tsv

optional arguments:
  -h, --help          show this help message and exit
  -q , --minPercent   float	minimum percentile for edit distance output (descending order, value must be between 0 and 100 inclusive), default 95
```

## Running script
```
python3 find_unique_isoform.py manifest.csv window_boundaries_step4_yq.bed unique_isoforms.tsv
```

## Input - manifest
```
HG002,HG002.bam,HG002.fa
HG004,HG004.bam,HG004.fa
HG005,HG005.bam,HG005.fa
```

## Output
Columns:
win_chr: window chr
win_start: window start
win_end: window end
total_isoform: total number of isoforms in the window
isoform_name: the seq id from the original fasta file
sample_from: sample this unique isoform is in
sample_compared_to: sample this isoform is unique to
mapped_start: mapping start (on reference genome)
isoform_sequence: the exact sequence from the original fasta file
selected_alignments: alignments (of isoforms) selected by 95% percentile edit distance, format in "percentage edit distance-isoform name-alignment cigar", multiple entries are delimited by comma
```
win_chr	win_start	win_end	total_isoform	isoform_name	sample_from	sample_compared_to	mapped_start	isoform_sequence	selected_alignments
NC_060925.1	255178	288416	4	PB.6.2	HG002	HG004	255184	GGAGCCAAGGTCCGCTCGGGTGAGTGCCCTCCGCTTTTTGTGGCCAAACCCAGCCACGCAGTCCCCTCCCTGCGGCGTCCTCCACACCCGGGGTCTGCTGGTCTCCGCGGATGTCACAGGCTCGGCAACCGCCCTCCTGTCGGCGGGGAGTCCCGCGACGCCCGGAAATGCTCCGAAGCCTGTCGCTCAGCTGCCAGATCTGCGTCTGTGTCCGGTTCCGTCACTGAGGTCGCCCCTGTCCGGCCCTTCCACCCTAGTTCTCTTCACCGTCCGCCCATCCTATCGCGCGCGGCCTCAGGTCCCCATTCGGCATGTGGCTTGTCTTCCATCGTCCCCACCCTCGCCCCTCTTGGCCCCTCAGGGCAGCCCTGGGATTCGGCAGACGCCAGTCCTCCCTGAGATGCTTCCCCGTCCTTCCCTCCGCCAGGCCCTACGTCTCCGCAAACCCCACGCTTCGGGGTGGCCGCCTCAGACAGGACCCTGAGTCCGAGACTGGGGTAGGGGACCTGCCCGATCCTGTAACAACCCTCGTGCTTCTGCACAATCGCCTCCCACTAGCGGTGACTGTTGGGTGTCTACCTTCCCGGTGTCCCACTGAGAAGCGGGCTCCTCCTTGGCAGGGGCTTCTTCATTGCCTCGCTGTGGATGTCGAGGTGGGGCAGGAGAGTGAGGAGAAAACAGAGAGGAGGGAGGTAGAGCCAACGAGCGAGAAAAGGGGAGGGAAGTTTAGATGGGAAGTGGATGGGTCTGAGGAATTTGAACAAACACCGACAGTGAAGGAGAGTGACCTGAGCAAGCAGTAGTGGGGTAAATGGAAATAGACAAAATGGGAATCAGCAGAGATATGGAGGACAGAATACAATGAGGAGGCCTTGACCGTCAGTAGCAGAGAGGGCAGCAGAAGCCTAATTCCCAAATTCCTTAGTGGTTTTCTGATTTCCAAATTAGTTTCCCTTTTAAATTTATTGTGTCAGGTTCAGCTTATGAGGCCTCAATACTTTTCAGTCTTAATTGTATATTGAAAATACTTTTTGTTTACTAAATGCTTTTTACATTAATTCAGTGTGCACTCCGTAAGGATATTGATGATTTGAGTTAGTTTAGTATTCAACAGCTTCCTCTATTCCTTTGTATGATCTCTGTATTTAATGGCTGTGGCATAAAGTTTCCAACTAAGTATAAGTATCAAGTTTTCTTTGTGATGTTTTCTGCAAATATTGAAGGATGACCTGGATTGTCCTAGAACTTTGTTCCAACAGATTACATGTGTTCATAACGAATAAATTGCTC	0.02_HG004_PB.6.2_3=6D1=3D1286=11D
NC_060925.1	255178	288416	4	PB.6.2	HG002	HG005	255184	GGAGCCAAGGTCCGCTCGGGTGAGTGCCCTCCGCTTTTTGTGGCCAAACCCAGCCACGCAGTCCCCTCCCTGCGGCGTCCTCCACACCCGGGGTCTGCTGGTCTCCGCGGATGTCACAGGCTCGGCAACCGCCCTCCTGTCGGCGGGGAGTCCCGCGACGCCCGGAAATGCTCCGAAGCCTGTCGCTCAGCTGCCAGATCTGCGTCTGTGTCCGGTTCCGTCACTGAGGTCGCCCCTGTCCGGCCCTTCCACCCTAGTTCTCTTCACCGTCCGCCCATCCTATCGCGCGCGGCCTCAGGTCCCCATTCGGCATGTGGCTTGTCTTCCATCGTCCCCACCCTCGCCCCTCTTGGCCCCTCAGGGCAGCCCTGGGATTCGGCAGACGCCAGTCCTCCCTGAGATGCTTCCCCGTCCTTCCCTCCGCCAGGCCCTACGTCTCCGCAAACCCCACGCTTCGGGGTGGCCGCCTCAGACAGGACCCTGAGTCCGAGACTGGGGTAGGGGACCTGCCCGATCCTGTAACAACCCTCGTGCTTCTGCACAATCGCCTCCCACTAGCGGTGACTGTTGGGTGTCTACCTTCCCGGTGTCCCACTGAGAAGCGGGCTCCTCCTTGGCAGGGGCTTCTTCATTGCCTCGCTGTGGATGTCGAGGTGGGGCAGGAGAGTGAGGAGAAAACAGAGAGGAGGGAGGTAGAGCCAACGAGCGAGAAAAGGGGAGGGAAGTTTAGATGGGAAGTGGATGGGTCTGAGGAATTTGAACAAACACCGACAGTGAAGGAGAGTGACCTGAGCAAGCAGTAGTGGGGTAAATGGAAATAGACAAAATGGGAATCAGCAGAGATATGGAGGACAGAATACAATGAGGAGGCCTTGACCGTCAGTAGCAGAGAGGGCAGCAGAAGCCTAATTCCCAAATTCCTTAGTGGTTTTCTGATTTCCAAATTAGTTTCCCTTTTAAATTTATTGTGTCAGGTTCAGCTTATGAGGCCTCAATACTTTTCAGTCTTAATTGTATATTGAAAATACTTTTTGTTTACTAAATGCTTTTTACATTAATTCAGTGTGCACTCCGTAAGGATATTGATGATTTGAGTTAGTTTAGTATTCAACAGCTTCCTCTATTCCTTTGTATGATCTCTGTATTTAATGGCTGTGGCATAAAGTTTCCAACTAAGTATAAGTATCAAGTTTTCTTTGTGATGTTTTCTGCAAATATTGAAGGATGACCTGGATTGTCCTAGAACTTTGTTCCAACAGATTACATGTGTTCATAACGAATAAATTGCTC	0.02_HG004_PB.6.2_3=6D1=3D1286=11D
```

